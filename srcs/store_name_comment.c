/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   write_binary.c                                     :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: lazrossi <marvin@42.fr>                    +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2018/09/20 10:48:41 by lazrossi          #+#    #+#             */
/*   Updated: 2018/10/10 18:58:14 by lazrossi         ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "../libft/includes/libft.h"
#include "../includes/asm.h"

static int		g_lexer[21][12][2] = {


// 	  0		 .		 n		  a		 m		 e		  c		  o		 t		  \n     "		 AN	
0  	{{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
                                                                                                 
1 	 {{0, 0}, {1, 1}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
  	                                                                                                
2 	 {{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
  	                                                                                                
3 	 {{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
  	                                                                                                
4 	 {{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
  	                                                                                                
5 	 {{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
  	                                                                                                
6 	 {{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
  	                                                                                                
7 	 {{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
  	                                                                                                
8 	 {{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
                                                                                                  
9    {{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
                                                                                                  
10   {{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
                                                                                                  
11   {{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
                                                                                                  
12   {{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
                                                                                                  
13   {{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
                                                                                                  
14   {{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
                                                                                                  
15   {{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
                                                                                                  
16   {{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
                                                                                                  
17   {{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
                                                                                                  
18   {{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
                                                                                                  
19   {{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},
                                                                                                    
20   {{0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}},

};

static unsigned	int	g_ascii_tab[128] = {
	0,
	11, 11, 11, 11, 11, 11, 11, 11, 11, 9,
	11, 11, 11, 11, 11, 11, 11, 11, 11, 11,
	11, 11, 11, 11, 11, 11, 11, 11, 11, 11,
	11, 11, 11, 10, 11, 11, 11, 11, 11, 11,
	11, 11, 11, 11, 11, 1, 11, 11, 11, 11,
	11, 11, 11, 11, 11, 11, 11, 11, 11, 11,
	11, 11, 11, 11, 11, 11, 11, 11, 11, 11,
	11, 11, 11, 11, 11, 11, 11, 11, 11, 11,
	11, 11, 11, 11, 11, 11, 11, 11, 11, 11,
	11, 11, 11, 11, 11, 11, 3, 11, 6, 11,
	5, 11, 11, 11, 11, 11, 11, 11, 4, 2,
	7, 11, 11, 11, 11, 8, 11, 11, 11, 11,
	11, 11, 11, 11, 11, 11, 11
};

static void	input_magic(t_info *info)
{
	info->header.magic = COREWAR_EXEC_MAGIC;
	if (ft_check_little_endianness())
		info->header.magic = little_endian_to_big(COREWAR_EXEC_MAGIC, sizeof(info->header.magic));
	else
		info->header.magic = COREWAR_EXEC_MAGIC;
}

static void	store_name_comment_2(t_info *info, int which, int quotes_end)
{
	if (!(ft_is_white_space_line(&info->file[info->read_pos] + 2 + quotes_end)))
		ft_myexit("Dangling characters\
 after quotes in line defining name or comment.");
	if (quotes_end > which)
		ft_myexit("Your champion's name or your comment is too long");
	if (which == PROG_NAME_LENGTH)
		ft_memset(&(info->header), 0, sizeof(info->header));
	ft_memcpy(which == (PROG_NAME_LENGTH) ?
	info->header.prog_name :
	info->header.comment, &info->file[info->read_pos] + 1, quotes_end);
	info->read_pos = ft_strchr(&info->file[info->read_pos], '\n') - info->file;
	if (which == PROG_NAME_LENGTH)
	{
		input_magic(info);
		store_name_comment(info, COMMENT_LENGTH); 
	}
}

void	store_name_comment(t_info *info, int which)
{
	unsigned int begin_state;
	unsigned int end_state;

	end_state = 1;
	while (begin_state)
	{
		begin_state = end_state;
	}
}
